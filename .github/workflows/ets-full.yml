name: ETS Full Pipeline

on:
  push:
    branches: [ main, ets_update_2, ets_update_3 ]
  workflow_dispatch:

jobs:

  ###########################################################################
  #  PHASE 1 — ENV SETUP
  ###########################################################################
  env_setup:
    uses: ./.github/workflows/ets-env-setup.yml


  ###########################################################################
  #  PHASE 2 — PROVIDER VALIDATION
  ###########################################################################
  provider_validation:
    needs: env_setup
    uses: ./.github/workflows/ets-provider-validate.yml


  ###########################################################################
  #  PHASE 3 — BACKTEST
  ###########################################################################
  backtest:
    needs: provider_validation
    uses: ./.github/workflows/ets-backtest.yml


  ###########################################################################
  #  PHASE 4 — FULL SMOKE + CLI
  ###########################################################################
  full_smoke:
    needs: backtest
    uses: ./.github/workflows/ets-smoke-cli.yml
